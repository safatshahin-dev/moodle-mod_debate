{"version":3,"sources":["../src/debate_view.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","init","userFullName","userImageURL","userID","courseID","debateID","responseAllowed","positiveResponse","negativeResponse","responseType","responseId","responseTextID","id","elementid","elementidContainer","editID","deleteID","delay","timer","callback","ms","clearTimeout","setTimeout","getAllocation","attr","result","keyup","remove","userResponsetext","val","length","responseAjax","call","methodname","args","courseid","debateid","response","responsetype","done","found","getResponses","JSON","parse","data","render","found_response","then","html","debateResponse","after","fail","exception","document","on","is","text","trim","css","animate","scrollTop","offset","top","userResponse","responseCall","output","outputContext","user_profile_image","user_full_name","elementidcontainer","user_capability","editid","deleteid","outputResponse"],"mappings":"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","sourcesContent":["/**\n * Js for debate page.\n *\n * @package     mod_debate\n * @copyright   2020 Safat Shahin <safatshahin@gmail.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str,\n             mdlcfg, notification, templates) {\n        var debateView = {\n            init: function(userFullName, userImageURL, userID, courseID, debateID,\n                           responseAllowed, positiveResponse, negativeResponse) {\n                var responseType = 0;\n                var responseId = '';\n                var responseTextID = '';\n                var id = null;\n                var elementid = '';\n                var elementidContainer = '';\n                var editID = '';\n                var deleteID = '';\n                var delay = (function() {\n                    var timer = 0;\n                    return function(callback, ms) {\n                        clearTimeout(timer);\n                        timer = setTimeout(callback, ms);\n                    };\n                })();\n                $.getAllocation = function(attr) {\n                    var result = true;\n                    switch (responseAllowed) {\n                        case '0':\n                            // UNLIMITED RESPONSE\n                            break;\n                        case '1':\n                            // ONE RESPONSE IN ANY ONE SIDE\n                            if (positiveResponse > 0 || negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                        case '2':\n                            // ONE RESPONSE IN EACH SIDE\n                            if (positiveResponse > 0 && negativeResponse > 0) {\n                                result = false;\n                            } else if (attr === 'positive' && positiveResponse > 0) {\n                                result = false;\n                            } else if (attr === 'negative' && negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                    }\n                    return result;\n                };\n                $(\".mod-debate-response-input\").keyup(function() {\n                    delay(function() {\n                        $(\"div\").remove(\".mod-debate-find-response\");\n                        var userResponsetext = $(responseTextID).val();\n                        if (userResponsetext.length > 0) {\n                            var responseAjax = AJAX.call([{\n                                methodname: 'mod_debate_find_debate_respose',\n                                args: {\n                                    courseid: courseID,\n                                    debateid: debateID,\n                                    response: userResponsetext,\n                                    responsetype: responseType\n                                }\n                            }]);\n                            responseAjax[0].done(function(found) {\n                                if (found.result) {\n                                    var getResponses = JSON.parse(found.data);\n                                    var context = {\n                                        found_response: getResponses\n                                    };\n                                    templates.render('mod_debate/debate_find_response', context).then(function(html, js) {\n                                        var debateResponse = $(responseId);\n                                        debateResponse.after(html);\n                                    }).fail(notification.exception);\n                                }\n                            }).fail(notification.exception);\n                        }\n                    }, 700);\n                });\n                $(document).on('click', '#mod-debate-negative-edit', function() {\n                    id = $(this).attr(\"data-id\");\n                    elementid = '#element' + id;\n                    elementidContainer = '#element' + id + 'container';\n                    var result = $.getAllocation('negative');\n                    if (result && $('#mod-debate-insert-postive-response').is(\":hidden\")\n                    && $('#mod-debate-insert-negative-response').is(\":hidden\")) {\n                        var text = $(elementid).text().trim();\n                        responseType = 0;\n                        responseId = '#mod-debate-insert-negative-response';\n                        responseTextID = '#mod-debate-negative-response-input';\n                        editID = 'mod-debate-negative-edit';\n                        deleteID = 'mod-debate-negative-delete';\n                        $(responseTextID).html(text);\n                        $(elementidContainer).css('display', 'none');\n                        $(responseId).css('display', 'block');\n                        $('html, body').animate({\n                            scrollTop: $(\"#mod-debate-neg-side\").offset().top\n                        }, 2000);\n                    }\n                });\n                $(document).on('click', '#mod-debate-positive-edit', function() {\n                    id = $(this).attr(\"data-id\");\n                    elementid = '#element' + id;\n                    elementidContainer = '#element' + id + 'container';\n                    var result = $.getAllocation('positive');\n                    if (result && $('#mod-debate-insert-negative-response').is(\":hidden\")\n                        && $('#mod-debate-insert-postive-response').is(\":hidden\")) {\n                        var text = $(elementid).text().trim();\n                        responseType = 1;\n                        responseId = '#mod-debate-insert-postive-response';\n                        responseTextID = '#mod-debate-positive-response-input';\n                        editID = 'mod-debate-positive-edit';\n                        deleteID = 'mod-debate-positive-delete';\n                        $(responseTextID).html(text);\n                        $(elementidContainer).css('display', 'none');\n                        $(responseId).css('display', 'block');\n                        $('html, body').animate({\n                            scrollTop: $(\"#mod-debate-pos-side\").offset().top\n                        }, 2000);\n                    }\n                });\n                $(document).on('click', '.mod-debate-positive-icon', function() {\n                    var result = $.getAllocation('positive');\n                    if (result && $('#mod-debate-insert-negative-response').is(\":hidden\")) {\n                        responseType = 1;\n                        responseId = '#mod-debate-insert-postive-response';\n                        responseTextID = '#mod-debate-positive-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '.mod-debate-negative-icon', function() {\n                    var result = $.getAllocation('negative');\n                    if (result && $('#mod-debate-insert-postive-response').is(\":hidden\")) {\n                        responseType = 0;\n                        responseId = '#mod-debate-insert-negative-response';\n                        responseTextID = '#mod-debate-negative-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '#mod-debate-cancel-respose', function() {\n                    $(responseId).css('display', 'none');\n                    $(elementidContainer).css('display', 'block');\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                });\n                $(document).on('click', '#mod-debate-update-response', function() {\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                    var userResponse = $(responseTextID).val();\n                    if (userResponse.length > 0) {\n                        var responseCall = AJAX.call([{\n                            methodname: 'mod_debate_add_debate_respose',\n                            args: {\n                                courseid: courseID,\n                                debateid: debateID,\n                                response: userResponse,\n                                responsetype: responseType,\n                                id: id\n                            }\n                        }]);\n                        responseCall[0].done(function(output) {\n                            if (output.result) {\n                                if (responseType === 0) {\n                                    negativeResponse++;\n                                } else {\n                                    positiveResponse++;\n                                }\n                                $(responseId).css('display', 'none');\n                                $(\"div\").remove(\".mod-debate-find-response\");\n                                $(elementidContainer).remove();\n                                var outputContext = {\n                                    user_profile_image: userImageURL,\n                                    user_full_name: userFullName,\n                                    response: userResponse,\n                                    elementidcontainer: 'element' + output.id + 'container',\n                                    elementid: 'element' + output.id,\n                                    user_capability: true,\n                                    id: id,\n                                    editid: editID,\n                                    deleteid: deleteID\n                                };\n                                templates.render('mod_debate/debate_response_output', outputContext).then(function (html, js) {\n                                    var outputResponse = $(responseId);\n                                    outputResponse.after(html);\n                                    id = null;\n                                }).fail(notification.exception);\n                            } else {\n                                //error checking\n                            }\n                        }).fail(notification.exception);\n                    }\n                });\n            }\n        };\n        return debateView;\n    });\n"],"file":"debate_view.min.js"}