{"version":3,"sources":["../src/debate_view.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","debateView","init","userFullName","userImageURL","userID","courseID","debateID","cmID","responseAllowed","positiveResponse","negativeResponse","responseType","responseId","getAllocation","attr","result","document","on","length","debateResponse","remove","userResponse","val","responseCall","call","methodname","args","courseid","debateid","cmid","response","responsetype","done","render","user_profile_image","user_full_name","then","html","outputResponse","after","fail","exception","responseClass","response_class","userid","js","runTemplateJS"],"mappings":"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","sourcesContent":["/**\n * js for debate page.\n *\n * @package     mod_debate\n * @copyright   2020 Safat Shahin <safatshahin@gmail.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str,\n             mdlcfg, notification, templates) {\n        var debateView = {\n            init: function(userFullName, userImageURL, userID, courseID, debateID, cmID,\n                           responseAllowed, positiveResponse, negativeResponse) {\n                var responseType = 0;\n                var responseId = '';\n                $.getAllocation = function(attr) {\n                    var result = true;\n                    switch (responseAllowed) {\n                        case '0':\n                            // UNLIMITED RESPONSE\n                            break;\n                        case '1':\n                            // ONE RESPONSE IN ANY ONE SIDE\n                            if (positiveResponse > 0 || negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                        case '2':\n                            // ONE RESPONSE IN EACH SIDE\n                            if (positiveResponse > 0 && negativeResponse > 0) {\n                                result = false;\n                            } else if (attr === 'positive' && positiveResponse > 0) {\n                                result = false;\n                            } else if (attr === 'negative' && negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                    }\n                    return result;\n                };\n                $(document).on('click', '.mod-debate-positive-icon', function() {\n                    var result = $.getAllocation('positive');\n                    if ($(\"#mod-debate-response-input\").length === 0 && result) {\n                        responseType = 1;\n                        responseId = '#mod-debate-pos-side';\n                        debateView.debateResponse(userFullName, userImageURL,\n                            'mod-debate-positive-response',\n                            responseId, userID, courseID, debateID, cmID, responseType);\n                    }\n                });\n                $(document).on('click', '.mod-debate-negative-icon', function() {\n                    var result = $.getAllocation('negative');\n                    if ($(\"#mod-debate-response-input\").length === 0 && result) {\n                        responseType = 0;\n                        responseId = '#mod-debate-neg-side';\n                        debateView.debateResponse(userFullName, userImageURL,\n                            'mod-debate-negative-response',\n                            responseId, userID, courseID, debateID, cmID, responseType);\n                    }\n                });\n                $(document).on('click', '#mod-debate-cancel-respose', function() {\n                    $('#' + userID + '-mod-debate').remove();\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                });\n                $(document).on('click', '#mod-debate-update-response', function() {\n                    var userResponse = $(\"#mod-debate-response-input\").val();\n                    var responseCall = AJAX.call([{\n                        methodname: 'mod_debate_add_debate_respose',\n                        args: {\n                            courseid: courseID,\n                            debateid: debateID,\n                            cmid: cmID,\n                            response: userResponse,\n                            responsetype: responseType\n                        }\n                    }]);\n                    responseCall[0].done(function(result) {\n                        if (result) {\n                            if (responseType === 0) {\n                                negativeResponse++;\n                            } else {\n                                positiveResponse++;\n                            }\n                            $('#' + userID + '-mod-debate').remove();\n                            $(\"div\").remove(\".mod-debate-find-response\");\n                            var outputContext = {\n                                user_profile_image: userImageURL,\n                                user_full_name: userFullName,\n                                response: userResponse\n                            };\n                            templates.render('mod_debate/debate_response_output', outputContext).then(function (html, js) {\n                                var outputResponse = $(responseId);\n                                outputResponse.after(html);\n                            }).fail(notification.exception);\n                        } else {\n                            //error checking\n                        }\n                    }).fail(notification.exception);\n                });\n            },\n            debateResponse: function(userFullName, userImageURL, responseClass,\n                                     responseId, userID, courseID, debateID, cmID, responseType) {\n                var context = {\n                    response_class: responseClass,\n                    user_profile_image: userImageURL,\n                    user_full_name: userFullName,\n                    userid: userID + '-mod-debate',\n                    courseid: courseID,\n                    debateid: debateID,\n                    cmid: cmID,\n                    responsetype: responseType\n                };\n                templates.render('mod_debate/debate_response', context).then(function (html, js) {\n                    var debateResponse = $(responseId);\n                    debateResponse.after(html);\n                    templates.runTemplateJS(js);\n                }).fail(notification.exception);\n            }\n        };\n        return debateView;\n    });\n"],"file":"debate_view.min.js"}