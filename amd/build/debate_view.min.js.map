{"version":3,"sources":["../src/debate_view.js"],"names":["define","$","AJAX","str","mdlcfg","notification","templates","init","userFullName","userImageURL","userID","courseID","debateID","responseAllowed","positiveResponse","negativeResponse","responseType","responseId","responseTextID","delay","timer","callback","ms","clearTimeout","setTimeout","getAllocation","attr","result","keyup","remove","userResponsetext","val","length","responseAjax","call","methodname","args","courseid","debateid","response","responsetype","done","found","getResponses","JSON","parse","data","render","found_response","then","html","debateResponse","after","fail","exception","document","on","is","css","userResponse","responseCall","user_profile_image","user_full_name","outputResponse"],"mappings":"AAQAA,OAAM,0BAAC,CAAC,QAAD,CAAW,WAAX,CAAwB,UAAxB,CAAoC,aAApC,CAAmD,mBAAnD,CAAwE,gBAAxE,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAAkBC,CAAlB,CACSC,CADT,CACiBC,CADjB,CAC+BC,CAD/B,CAC0C,CAmItC,MAlIiB,CACbC,IAAI,CAAE,cAASC,CAAT,CAAuBC,CAAvB,CAAqCC,CAArC,CAA6CC,CAA7C,CAAuDC,CAAvD,CACSC,CADT,CAC0BC,CAD1B,CAC4CC,CAD5C,CAC8D,IAC5DC,CAAAA,CAAY,CAAG,CAD6C,CAE5DC,CAAU,CAAG,EAF+C,CAG5DC,CAAc,CAAG,EAH2C,CAI5DC,CAAK,CAAI,UAAW,CACpB,GAAIC,CAAAA,CAAK,CAAG,CAAZ,CACA,MAAO,UAASC,CAAT,CAAmBC,CAAnB,CAAuB,CAC1BC,YAAY,CAACH,CAAD,CAAZ,CACAA,CAAK,CAAGI,UAAU,CAACH,CAAD,CAAWC,CAAX,CACrB,CACJ,CANW,EAJoD,CAWhErB,CAAC,CAACwB,aAAF,CAAkB,SAASC,CAAT,CAAe,CAC7B,GAAIC,CAAAA,CAAM,GAAV,CACA,OAAQd,CAAR,EACI,IAAK,GAAL,CAEI,MACJ,IAAK,GAAL,CAEI,GAAuB,CAAnB,CAAAC,CAAgB,EAA2B,CAAnB,CAAAC,CAA5B,CAAkD,CAC9CY,CAAM,GACT,CACD,MACJ,IAAK,GAAL,CAEI,GAAuB,CAAnB,CAAAb,CAAgB,EAA2B,CAAnB,CAAAC,CAA5B,CAAkD,CAC9CY,CAAM,GACT,CAFD,IAEO,IAAa,UAAT,GAAAD,CAAI,EAAsC,CAAnB,CAAAZ,CAA3B,CAAiD,CACpDa,CAAM,GACT,CAFM,IAEA,IAAa,UAAT,GAAAD,CAAI,EAAsC,CAAnB,CAAAX,CAA3B,CAAiD,CACpDY,CAAM,GACT,CACD,MAnBR,CAqBA,MAAOA,CAAAA,CACV,CAxBD,CAyBA1B,CAAC,CAAC,4BAAD,CAAD,CAAgC2B,KAAhC,CAAsC,UAAW,CAC7CT,CAAK,CAAC,UAAW,CACblB,CAAC,CAAC,KAAD,CAAD,CAAS4B,MAAT,CAAgB,2BAAhB,EACA,GAAIC,CAAAA,CAAgB,CAAG7B,CAAC,CAACiB,CAAD,CAAD,CAAkBa,GAAlB,EAAvB,CACA,GAA8B,CAA1B,CAAAD,CAAgB,CAACE,MAArB,CAAiC,CAC7B,GAAIC,CAAAA,CAAY,CAAG/B,CAAI,CAACgC,IAAL,CAAU,CAAC,CAC1BC,UAAU,CAAE,gCADc,CAE1BC,IAAI,CAAE,CACFC,QAAQ,CAAE1B,CADR,CAEF2B,QAAQ,CAAE1B,CAFR,CAGF2B,QAAQ,CAAET,CAHR,CAIFU,YAAY,CAAExB,CAJZ,CAFoB,CAAD,CAAV,CAAnB,CASAiB,CAAY,CAAC,CAAD,CAAZ,CAAgBQ,IAAhB,CAAqB,SAASC,CAAT,CAAgB,CACjC,GAAIA,CAAK,CAACf,MAAV,CAAkB,IACVgB,CAAAA,CAAY,CAAGC,IAAI,CAACC,KAAL,CAAWH,CAAK,CAACI,IAAjB,CADL,CAKdxC,CAAS,CAACyC,MAAV,CAAiB,iCAAjB,CAHc,CACVC,cAAc,CAAEL,CADN,CAGd,EAA6DM,IAA7D,CAAkE,SAASC,CAAT,CAAmB,CACjF,GAAIC,CAAAA,CAAc,CAAGlD,CAAC,CAACgB,CAAD,CAAtB,CACAkC,CAAc,CAACC,KAAf,CAAqBF,CAArB,CACH,CAHD,EAGGG,IAHH,CAGQhD,CAAY,CAACiD,SAHrB,CAIH,CACJ,CAXD,EAWGD,IAXH,CAWQhD,CAAY,CAACiD,SAXrB,CAYH,CACJ,CA1BI,CA0BF,GA1BE,CA2BR,CA5BD,EA6BArD,CAAC,CAACsD,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,CAAwB,2BAAxB,CAAqD,UAAW,CAC5D,GAAI7B,CAAAA,CAAM,CAAG1B,CAAC,CAACwB,aAAF,CAAgB,UAAhB,CAAb,CACA,GAAIE,CAAM,EAAI1B,CAAC,CAAC,sCAAD,CAAD,CAA0CwD,EAA1C,CAA6C,SAA7C,CAAd,CAAuE,CACnEzC,CAAY,CAAG,CAAf,CACAC,CAAU,CAAG,qCAAb,CACAC,CAAc,CAAG,qCAAjB,CACAjB,CAAC,CAACiB,CAAD,CAAD,CAAkBa,GAAlB,CAAsB,EAAtB,EACA9B,CAAC,CAACgB,CAAD,CAAD,CAAcyC,GAAd,CAAkB,SAAlB,CAA6B,OAA7B,CACH,CACJ,CATD,EAUAzD,CAAC,CAACsD,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,CAAwB,2BAAxB,CAAqD,UAAW,CAC5D,GAAI7B,CAAAA,CAAM,CAAG1B,CAAC,CAACwB,aAAF,CAAgB,UAAhB,CAAb,CACA,GAAIE,CAAM,EAAI1B,CAAC,CAAC,qCAAD,CAAD,CAAyCwD,EAAzC,CAA4C,SAA5C,CAAd,CAAsE,CAClEzC,CAAY,CAAG,CAAf,CACAC,CAAU,CAAG,sCAAb,CACAC,CAAc,CAAG,qCAAjB,CACAjB,CAAC,CAACiB,CAAD,CAAD,CAAkBa,GAAlB,CAAsB,EAAtB,EACA9B,CAAC,CAACgB,CAAD,CAAD,CAAcyC,GAAd,CAAkB,SAAlB,CAA6B,OAA7B,CACH,CACJ,CATD,EAUAzD,CAAC,CAACsD,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,CAAwB,4BAAxB,CAAsD,UAAW,CAC7DvD,CAAC,CAACgB,CAAD,CAAD,CAAcyC,GAAd,CAAkB,SAAlB,CAA6B,MAA7B,EACAzD,CAAC,CAAC,KAAD,CAAD,CAAS4B,MAAT,CAAgB,2BAAhB,CACH,CAHD,EAIA5B,CAAC,CAACsD,QAAD,CAAD,CAAYC,EAAZ,CAAe,OAAf,CAAwB,6BAAxB,CAAuD,UAAW,CAC9DvD,CAAC,CAAC,KAAD,CAAD,CAAS4B,MAAT,CAAgB,2BAAhB,EACA,GAAI8B,CAAAA,CAAY,CAAG1D,CAAC,CAACiB,CAAD,CAAD,CAAkBa,GAAlB,EAAnB,CACA,GAA0B,CAAtB,CAAA4B,CAAY,CAAC3B,MAAjB,CAA6B,CACzB,GAAI4B,CAAAA,CAAY,CAAG1D,CAAI,CAACgC,IAAL,CAAU,CAAC,CAC1BC,UAAU,CAAE,+BADc,CAE1BC,IAAI,CAAE,CACFC,QAAQ,CAAE1B,CADR,CAEF2B,QAAQ,CAAE1B,CAFR,CAGF2B,QAAQ,CAAEoB,CAHR,CAIFnB,YAAY,CAAExB,CAJZ,CAFoB,CAAD,CAAV,CAAnB,CASA4C,CAAY,CAAC,CAAD,CAAZ,CAAgBnB,IAAhB,CAAqB,SAASd,CAAT,CAAiB,CAClC,GAAIA,CAAJ,CAAY,CACR,GAAqB,CAAjB,GAAAX,CAAJ,CAAwB,CACpBD,CAAgB,EACnB,CAFD,IAEO,CACHD,CAAgB,EACnB,CACDb,CAAC,CAACgB,CAAD,CAAD,CAAcyC,GAAd,CAAkB,SAAlB,CAA6B,MAA7B,EACAzD,CAAC,CAAC,KAAD,CAAD,CAAS4B,MAAT,CAAgB,2BAAhB,EAMAvB,CAAS,CAACyC,MAAV,CAAiB,mCAAjB,CALoB,CAChBc,kBAAkB,CAAEpD,CADJ,CAEhBqD,cAAc,CAAEtD,CAFA,CAGhB+B,QAAQ,CAAEoB,CAHM,CAKpB,EAAqEV,IAArE,CAA0E,SAAUC,CAAV,CAAoB,CAC1F,GAAIa,CAAAA,CAAc,CAAG9D,CAAC,CAACgB,CAAD,CAAtB,CACA8C,CAAc,CAACX,KAAf,CAAqBF,CAArB,CACH,CAHD,EAGGG,IAHH,CAGQhD,CAAY,CAACiD,SAHrB,CAIH,CAGJ,CArBD,EAqBGD,IArBH,CAqBQhD,CAAY,CAACiD,SArBrB,CAsBH,CACJ,CApCD,CAqCH,CAhIY,CAmIpB,CAtIC,CAAN","sourcesContent":["/**\n * Js for debate page.\n *\n * @package     mod_debate\n * @copyright   2020 Safat Shahin <safatshahin@gmail.com>\n * @license     https://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\ndefine(['jquery', 'core/ajax', 'core/str', 'core/config', 'core/notification', 'core/templates'],\n    function($, AJAX, str,\n             mdlcfg, notification, templates) {\n        var debateView = {\n            init: function(userFullName, userImageURL, userID, courseID, debateID,\n                           responseAllowed, positiveResponse, negativeResponse) {\n                var responseType = 0;\n                var responseId = '';\n                var responseTextID = '';\n                var delay = (function() {\n                    var timer = 0;\n                    return function(callback, ms) {\n                        clearTimeout(timer);\n                        timer = setTimeout(callback, ms);\n                    };\n                })();\n                $.getAllocation = function(attr) {\n                    var result = true;\n                    switch (responseAllowed) {\n                        case '0':\n                            // UNLIMITED RESPONSE\n                            break;\n                        case '1':\n                            // ONE RESPONSE IN ANY ONE SIDE\n                            if (positiveResponse > 0 || negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                        case '2':\n                            // ONE RESPONSE IN EACH SIDE\n                            if (positiveResponse > 0 && negativeResponse > 0) {\n                                result = false;\n                            } else if (attr === 'positive' && positiveResponse > 0) {\n                                result = false;\n                            } else if (attr === 'negative' && negativeResponse > 0) {\n                                result = false;\n                            }\n                            break;\n                    }\n                    return result;\n                };\n                $(\".mod-debate-response-input\").keyup(function() {\n                    delay(function() {\n                        $(\"div\").remove(\".mod-debate-find-response\");\n                        var userResponsetext = $(responseTextID).val();\n                        if (userResponsetext.length > 0) {\n                            var responseAjax = AJAX.call([{\n                                methodname: 'mod_debate_find_debate_respose',\n                                args: {\n                                    courseid: courseID,\n                                    debateid: debateID,\n                                    response: userResponsetext,\n                                    responsetype: responseType\n                                }\n                            }]);\n                            responseAjax[0].done(function(found) {\n                                if (found.result) {\n                                    var getResponses = JSON.parse(found.data);\n                                    var context = {\n                                        found_response: getResponses\n                                    };\n                                    templates.render('mod_debate/debate_find_response', context).then(function(html, js) {\n                                        var debateResponse = $(responseId);\n                                        debateResponse.after(html);\n                                    }).fail(notification.exception);\n                                }\n                            }).fail(notification.exception);\n                        }\n                    }, 700);\n                });\n                $(document).on('click', '.mod-debate-positive-icon', function() {\n                    var result = $.getAllocation('positive');\n                    if (result && $('#mod-debate-insert-negative-response').is(\":hidden\")) {\n                        responseType = 1;\n                        responseId = '#mod-debate-insert-postive-response';\n                        responseTextID = '#mod-debate-positive-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '.mod-debate-negative-icon', function() {\n                    var result = $.getAllocation('negative');\n                    if (result && $('#mod-debate-insert-postive-response').is(\":hidden\")) {\n                        responseType = 0;\n                        responseId = '#mod-debate-insert-negative-response';\n                        responseTextID = '#mod-debate-negative-response-input';\n                        $(responseTextID).val('');\n                        $(responseId).css('display', 'block');\n                    }\n                });\n                $(document).on('click', '#mod-debate-cancel-respose', function() {\n                    $(responseId).css('display', 'none');\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                });\n                $(document).on('click', '#mod-debate-update-response', function() {\n                    $(\"div\").remove(\".mod-debate-find-response\");\n                    var userResponse = $(responseTextID).val();\n                    if (userResponse.length > 0) {\n                        var responseCall = AJAX.call([{\n                            methodname: 'mod_debate_add_debate_respose',\n                            args: {\n                                courseid: courseID,\n                                debateid: debateID,\n                                response: userResponse,\n                                responsetype: responseType\n                            }\n                        }]);\n                        responseCall[0].done(function(result) {\n                            if (result) {\n                                if (responseType === 0) {\n                                    negativeResponse++;\n                                } else {\n                                    positiveResponse++;\n                                }\n                                $(responseId).css('display', 'none');\n                                $(\"div\").remove(\".mod-debate-find-response\");\n                                var outputContext = {\n                                    user_profile_image: userImageURL,\n                                    user_full_name: userFullName,\n                                    response: userResponse\n                                };\n                                templates.render('mod_debate/debate_response_output', outputContext).then(function (html, js) {\n                                    var outputResponse = $(responseId);\n                                    outputResponse.after(html);\n                                }).fail(notification.exception);\n                            } else {\n                                //error checking\n                            }\n                        }).fail(notification.exception);\n                    }\n                });\n            }\n        };\n        return debateView;\n    });\n"],"file":"debate_view.min.js"}